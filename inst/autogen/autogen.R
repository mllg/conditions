capitalize = function(x) {
  substr(x, 1L, 1L) = toupper(substr(x, 1L, 1L))
  x
}

types = c("message", "warning", "error")
funs = c("message", "warning", "stop")

conditions = c(
  "assertion",
  "deprecated",
  "defunct",
  "dimension",
  "future",
  "index",
  "io",
  "length",
  "library",
  "lookup",
  "missing",
  "name",
  "runtime",
  "type",
  "value"
)

template = ("
#' @useDynLib conditions condition_{type}_
#' @rdname condition
#' @export
{condition}{capitalize(type)} = function(message, call = sys.call(-1L), attach = NULL) {{
  {fun}(.Call(condition_{type}_, \"{condition}\", message, call, attach, PACKAGE = \"conditions\"))
}}

#' @rdname as_condition
#' @export
as_{condition}{capitalize(type)} = function(message = NULL) {{
  as_{type}(\"{condition}\", message)
}}

")

grid = expand.grid(condition = conditions, type = types, stringsAsFactors = FALSE)
grid$fun = ifelse(grid$type == "error", "stop", grid$type)
lines = glue::glue_data(grid, template)

path = devtools::as.package(".")$path
writeLines(lines, file.path(path, "R", "autogenerated.R"))
